<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>datamanipulation_for_table_3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="248_datamanipulation_for_table_3_files/libs/clipboard/clipboard.min.js"></script>
<script src="248_datamanipulation_for_table_3_files/libs/quarto-html/quarto.js"></script>
<script src="248_datamanipulation_for_table_3_files/libs/quarto-html/popper.min.js"></script>
<script src="248_datamanipulation_for_table_3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="248_datamanipulation_for_table_3_files/libs/quarto-html/anchor.min.js"></script>
<link href="248_datamanipulation_for_table_3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="248_datamanipulation_for_table_3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="248_datamanipulation_for_table_3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="248_datamanipulation_for_table_3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="248_datamanipulation_for_table_3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="manipulation-for-table_3" class="level1">
<h1>Manipulation for table_3</h1>
<iframe width="560" height="315" src="https://www.youtube.com/embed/sM2F_5fh9Ks?si=BmYkqNK-UtsXBI7x" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="">
</iframe>
<section id="데이터-준비" class="level2">
<h2 class="anchored" data-anchor-id="데이터-준비">데이터 준비</h2>
<p>데이터 표를 만드는 실습은 6차 근로환경조사 자료를 통해 실습할 것입니다.. 자료는 안전보건공단, 근로환경조사 원시자료 사이트 (http://kosha.or.kr/kosha/data/primitiveData.do) 에서 신청할 수 있습니다..</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"tidyverse"</span>)) <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"htmlTable"</span>)) <span class="fu">install.packages</span>(<span class="st">"htmlTable"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"haven"</span>)) <span class="fu">install.packages</span>(<span class="st">"haven"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"broom"</span>)) <span class="fu">install.packages</span>(<span class="st">"broom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>데이터 표를 만드는 실습은 6차 근로환경조사 자료를 통해 실습할 것입니다.. 자료는 안전보건공단, 근로환경조사 원시자료 사이트 (http://kosha.or.kr/kosha/data/primitiveData.do) 에서 신청할 수 있습니다.. 데이터를 불러오겠습니다. 안전보건공단 홈페이에서 자료를 다운 받는게 원칙입니다. 다만 실습을 빠르게 진행하기 위해서, dspubs.org 페이지에 있는 파일을 이용하겠습니다. <br> <a href="https://raw.githubusercontent.com/jinhaslab/opendata/main/kwcs/kwcsData6th.rds"> kwcsData6th.rds </a> <br> 자신의 folder에 data 라는 folder가 있는지 확인하십시오. data라는 폴더에 다운로드하고, 불러오도록 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/jinhaslab/opendata/main/kwcs/kwcsData6th.rds"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(url, <span class="st">"data/tutorKWCS.rds"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>kwcs <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">"data/tutorKWCS.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="근로환경조사-기본-변수-생성-선택" class="level3">
<h3 class="anchored" data-anchor-id="근로환경조사-기본-변수-생성-선택">근로환경조사 기본 변수 생성 (선택)</h3>
<p>data manipulation에서 실습한 내용을 통해 변수를 실습을 위한 변수를 생성해 보겠습니다. 이에 대한 자세한 과정은 이전 챔터에 있습니다. <br></p>
<p><a href="#Tables2">Table 1 변수 생성과정 챕터</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data manip function</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Likert5f <span class="ot">=</span> <span class="cf">function</span>(x){dplyr<span class="sc">::</span><span class="fu">recode</span>(<span class="fu">as.numeric</span>(x), </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"4.Always"</span>,<span class="st">"3.Often"</span>,<span class="st">"2.Sometimes"</span>, <span class="st">"1.Rarely"</span>,<span class="st">"0.Never"</span> )}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># data step start ----------</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> kwcs <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AGE <span class="sc">&lt;</span><span class="dv">70</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AGE <span class="sc">&gt;</span><span class="dv">18</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sleep --------</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sleep1)<span class="sc">&amp;!</span><span class="fu">is.na</span>(sleep2)<span class="sc">&amp;!</span><span class="fu">is.na</span>(sleep3)) <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sleep1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>         sleep2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>         sleep3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sleep1in =</span> <span class="dv">5</span><span class="sc">-</span>sleep1, </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">sleep2in =</span> <span class="dv">5</span><span class="sc">-</span>sleep2,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">sleep3in =</span> <span class="dv">5</span><span class="sc">-</span>sleep3</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sleepgp =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    sleep1in <span class="sc">+</span> sleep2in<span class="sc">+</span> sleep3in <span class="sc">&gt;=</span><span class="dv">6</span> <span class="sc">~</span> <span class="st">"1.sleep disturbance"</span>, </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"0.non distrubance"</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># work live balances -------------</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wbalance), <span class="sc">!</span><span class="fu">is.na</span>(wwa1), <span class="sc">!</span><span class="fu">is.na</span>(wwa2), <span class="sc">!</span><span class="fu">is.na</span>(wwa3), <span class="sc">!</span><span class="fu">is.na</span>(wwa4), <span class="sc">!</span><span class="fu">is.na</span>(wwa5)) <span class="sc">%&gt;%</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wbalance)) <span class="sc">%&gt;%</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wbalancegp =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    wbalance <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"0.balance"</span>, </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"1.non balance"</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wwa1gp=</span><span class="fu">Likert5f</span>(wwa1), <span class="at">wwa2gp=</span><span class="fu">Likert5f</span>(wwa2),  <span class="at">wwa3gp=</span><span class="fu">Likert5f</span>(wwa3), </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">wwa4gp=</span><span class="fu">Likert5f</span>(wwa4), <span class="at">wwa5gp=</span><span class="fu">Likert5f</span>(wwa5), </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># job and sex, agegp  ----------</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(job1))<span class="sc">%&gt;%</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(job1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexgp =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    TSEX <span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">"Men"</span>, </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Women"</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agegp =</span> <span class="fu">case_when</span>(AGE <span class="sc">&lt;</span><span class="dv">25</span> <span class="sc">~</span> <span class="st">"&lt;25"</span>, AGE <span class="sc">&lt;</span><span class="dv">30</span> <span class="sc">~</span> <span class="st">"&lt;30"</span>,  AGE <span class="sc">&lt;</span><span class="dv">35</span> <span class="sc">~</span> <span class="st">"&lt;35"</span>, </span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    AGE <span class="sc">&lt;</span><span class="dv">40</span> <span class="sc">~</span> <span class="st">"&lt;40"</span>, AGE <span class="sc">&lt;</span><span class="dv">45</span> <span class="sc">~</span> <span class="st">"&lt;45"</span>, AGE <span class="sc">&lt;</span><span class="dv">50</span> <span class="sc">~</span> <span class="st">"&lt;50"</span>,AGE <span class="sc">&lt;</span><span class="dv">55</span> <span class="sc">~</span> <span class="st">"&lt;55"</span>, AGE <span class="sc">&lt;</span><span class="dv">60</span> <span class="sc">~</span> <span class="st">"&lt;60"</span>,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"\u226560"</span> <span class="co"># 나머지는 모두 &gt;65 (\u2265는 크거나 같다는 symbol)</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(edu)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(edu <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">edugp =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    edu <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">~</span>    <span class="st">"2.middle school or below"</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    edu <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>  ) <span class="sc">~</span>    <span class="st">"1.high school"</span>,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    edu <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>)   <span class="sc">~</span>  <span class="st">"0.university or more"</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">njob=</span><span class="fu">case_when</span>(</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    job1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>) <span class="sc">~</span> <span class="st">"1.njob"</span>, </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"0.one-job"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pains back -----------</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">backpain=</span> <span class="fu">case_when</span>(</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    heal_prob1<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">"pain"</span>, </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"no-pain"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># emp_type,working hours, shiftwork, work life balance -------</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(emp_type)) <span class="sc">%&gt;%</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(emp_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">empgp =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    emp_type <span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">"2.own-account worker"</span>, </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    emp_type <span class="sc">==</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">"1.employer/self-employer"</span>, </span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    emp_type <span class="sc">==</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">"0.paid-worker"</span>, </span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    emp_type <span class="sc">==</span><span class="dv">4</span> <span class="sc">~</span> <span class="st">"3.unpaind family work"</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wtime_week)) <span class="sc">%&gt;%</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">whgp=</span><span class="fu">case_when</span>(</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    wtime_week <span class="sc">&lt;</span> <span class="dv">35</span> <span class="sc">~</span> <span class="st">"&lt;35"</span>, </span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    wtime_week <span class="sc">&lt;</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">"&lt;40"</span>, </span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    wtime_week <span class="sc">&lt;</span> <span class="dv">52</span> <span class="sc">~</span> <span class="st">"&lt;52"</span>, </span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    wtime_week <span class="sc">&lt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"&lt;60"</span>, </span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"\u226560"</span>, </span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wtime_length5)) <span class="sc">%&gt;%</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wtime_length5 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">shiftWork =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    wtime_length5 <span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">"1.shift work"</span>, </span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"0.non shift work"</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wtime_resilience)) <span class="sc">%&gt;%</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">shortReturn =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    wtime_resilience <span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">"1.short return"</span>, </span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"0.non short return"</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(satisfaction)) <span class="sc">%&gt;%</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(satisfaction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">satisInv =</span> <span class="dv">5</span><span class="sc">-</span>satisfaction) <span class="sc">%&gt;%</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">shiftShort=</span><span class="fu">case_when</span>(</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    shiftWork <span class="sc">==</span> <span class="st">"1.shift work"</span> <span class="sc">&amp;</span> shortReturn <span class="sc">==</span> <span class="st">"1.short return"</span> <span class="sc">~</span> <span class="st">"3.shift work with short return"</span>, </span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    shiftWork <span class="sc">==</span> <span class="st">"1.shift work"</span> <span class="sc">&amp;</span> shortReturn <span class="sc">!=</span> <span class="st">"1.short return"</span> <span class="sc">~</span> <span class="st">"2.shift work"</span>, </span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>    shiftWork <span class="sc">!=</span> <span class="st">"1.shift work"</span> <span class="sc">&amp;</span> shortReturn <span class="sc">==</span> <span class="st">"1.short return"</span> <span class="sc">~</span> <span class="st">"1.day work with short return"</span>, </span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    shiftWork <span class="sc">!=</span> <span class="st">"1.shift work"</span> <span class="sc">&amp;</span> shortReturn <span class="sc">!=</span> <span class="st">"1.short return"</span> <span class="sc">~</span> <span class="st">"0.day work"</span>, </span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>  )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>코드를 간단히 하기 위해 <code>dat1</code>을 저장하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(dat1, <span class="st">"data/kwcsData1.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="함수를-source-file-로-저장하기" class="level3">
<h3 class="anchored" data-anchor-id="함수를-source-file-로-저장하기">함수를 source file 로 저장하기</h3>
<p>이전에 만들었던 함수 kwcsTabf.R 이라는 파일로 저장하겠습니다. <br> 이전에 만들었던 함수는 <a href="#kwcsfunction">kwcs table 1 함수 만들기</a>에 있습니다. 그 함수를 source 파일로 저장하겠습니다.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/2QhSmNjjwgQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
<ul>
<li>source file 사용
<ul>
<li>함수를 R script로 저장 (“source/kwcsTabf.R”)</li>
<li>source file 불러오기 (source(“source/kwcsTabf.R”))</li>
<li>함수 사용하기.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"source/kwcsTabf.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"tidyverse"</span>)) <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"htmlTable"</span>)) <span class="fu">install.packages</span>(<span class="st">"htmlTable"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"haven"</span>)) <span class="fu">install.packages</span>(<span class="st">"haven"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"broom"</span>)) <span class="fu">install.packages</span>(<span class="st">"broom"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"source/kwcsTabf.R"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">"data/kwcsData1.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>층화변수, 명목변수, 연속변수를 구성하여 함수를 실행해 보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Variables selection</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>stratas  <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"sleepgp"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>catVars <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># interesting</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"wbalancegp",</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wwa1gp"</span>, <span class="st">"wwa2gp"</span>,<span class="st">"wwa3gp"</span>,<span class="st">"wwa4gp"</span>,<span class="st">"wwa5gp"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># confounder</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"whgp", </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"shortReturn"</span>,<span class="st">"shiftWork"</span> , <span class="st">"njob"</span>, </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># demograhpics</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sexgp"</span>, <span class="st">"agegp"</span>, </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"edugp"</span>, <span class="st">"empgp"</span> <span class="co">#, backpain" </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>conVars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"AGE"</span>,<span class="st">"satisfaction"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>tab1 <span class="ot">=</span> <span class="fu">kwcsTabf</span>(<span class="at">dat1=</span>dat1, <span class="at">stratas =</span> stratas, <span class="at">catVars =</span> catVars, <span class="at">conVars =</span> conVars)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>tab1 <span class="sc">%&gt;%</span> </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">""</span>, <span class="st">""</span>, <span class="st">"None"</span>, <span class="st">"Disturbance"</span>, <span class="st">"P value"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">htmlTable</span>(</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">cgroup =</span> <span class="fu">c</span>(<span class="st">""</span>,  <span class="st">"Sleep disturbance"</span>, <span class="st">""</span>), </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">n.cgroup =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>), </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">tfoot =</span> <span class="st">"P value calculated by Chisq-Test and T-Test"</span>, </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">rnames =</span> <span class="cn">FALSE</span>, </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Basic Characteristics according to Sleep disturbance"</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr><td colspan="7" style="text-align: left;">
Basic Characteristics according to Sleep disturbance</td></tr>
<tr>
<th colspan="2" style="font-weight: 900; border-top: 2px solid grey; text-align: center;"></th><th style="border-bottom: none; border-top: 2px solid grey;" colspan="1">&nbsp;</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">Sleep disturbance</th><th style="border-bottom: none; border-top: 2px solid grey;" colspan="1">&nbsp;</th>
<th colspan="1" style="font-weight: 900; border-top: 2px solid grey; text-align: center;"></th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;"></th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;"></th> 
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;" colspan="1">&nbsp;</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">None</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">Disturbance</th> 
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;" colspan="1">&nbsp;</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">P value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">Never</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">12222 (94.7%)</td>
<td style="text-align: center;">684 (5.3%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Rarely</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">12316 (94.5%)</td>
<td style="text-align: center;">714 (5.5%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Sometimes</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">9112 (90.3%)</td>
<td style="text-align: center;">981 (9.7%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Often</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">3456 (82.8%)</td>
<td style="text-align: center;">717 (17.2%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Always</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">634 (70.0%)</td>
<td style="text-align: center;">272 (30.0%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">wwa2gp</td>
<td style="text-align: center;">Never</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">12432 (95.4%)</td>
<td style="text-align: center;">597 (4.6%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Rarely</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">13682 (94.1%)</td>
<td style="text-align: center;">863 (5.9%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Sometimes</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">8882 (89.2%)</td>
<td style="text-align: center;">1072 (10.8%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Often</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">2460 (79.4%)</td>
<td style="text-align: center;">638 (20.6%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Always</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">284 (58.9%)</td>
<td style="text-align: center;">198 (41.1%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">wwa3gp</td>
<td style="text-align: center;">Never</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">13472 (95.2%)</td>
<td style="text-align: center;">682 (4.8%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Rarely</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">13938 (93.1%)</td>
<td style="text-align: center;">1040 (6.9%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Sometimes</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">7749 (89.9%)</td>
<td style="text-align: center;">868 (10.1%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Often</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">2314 (79.5%)</td>
<td style="text-align: center;">597 (20.5%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Always</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">267 (59.6%)</td>
<td style="text-align: center;">181 (40.4%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">wwa4gp</td>
<td style="text-align: center;">Never</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">18708 (94.1%)</td>
<td style="text-align: center;">1169 (5.9%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Rarely</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">14799 (91.6%)</td>
<td style="text-align: center;">1362 (8.4%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Sometimes</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">3348 (85.0%)</td>
<td style="text-align: center;">592 (15.0%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Often</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">805 (80.7%)</td>
<td style="text-align: center;">193 (19.3%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Always</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">80 (60.6%)</td>
<td style="text-align: center;">52 (39.4%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">wwa5gp</td>
<td style="text-align: center;">Never</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">19061 (93.9%)</td>
<td style="text-align: center;">1245 (6.1%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Rarely</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">14770 (91.6%)</td>
<td style="text-align: center;">1349 (8.4%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Sometimes</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">3180 (85.3%)</td>
<td style="text-align: center;">550 (14.7%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Often</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">682 (79.8%)</td>
<td style="text-align: center;">173 (20.2%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Always</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">47 (48.0%)</td>
<td style="text-align: center;">51 (52.0%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">shortReturn</td>
<td style="text-align: center;">non short return</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">36183 (92.5%)</td>
<td style="text-align: center;">2927 (7.5%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">short return</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">1557 (77.9%)</td>
<td style="text-align: center;">441 (22.1%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">shiftWork</td>
<td style="text-align: center;">non shift work</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">35056 (91.9%)</td>
<td style="text-align: center;">3073 (8.1%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">shift work</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">2684 (90.1%)</td>
<td style="text-align: center;">295 (9.9%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">njob</td>
<td style="text-align: center;">one-job</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">37471 (91.9%)</td>
<td style="text-align: center;">3317 (8.1%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">njob</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">269 (84.1%)</td>
<td style="text-align: center;">51 (15.9%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">sexgp</td>
<td style="text-align: center;">Men</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">17892 (93.1%)</td>
<td style="text-align: center;">1327 (6.9%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Women</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">19848 (90.7%)</td>
<td style="text-align: center;">2041 (9.3%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">agegp</td>
<td style="text-align: center;">&lt;25</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">1359 (96.6%)</td>
<td style="text-align: center;">48 (3.4%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">&lt;30</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">2697 (94.3%)</td>
<td style="text-align: center;">163 (5.7%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">&lt;35</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">3308 (93.6%)</td>
<td style="text-align: center;">225 (6.4%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">&lt;40</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">3995 (92.3%)</td>
<td style="text-align: center;">334 (7.7%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">&lt;45</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">4414 (92.2%)</td>
<td style="text-align: center;">372 (7.8%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">&lt;50</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">4934 (92.7%)</td>
<td style="text-align: center;">388 (7.3%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">&lt;55</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">5300 (91.9%)</td>
<td style="text-align: center;">465 (8.1%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">&lt;60</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">5099 (90.0%)</td>
<td style="text-align: center;">566 (10.0%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">≥60</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">6634 (89.2%)</td>
<td style="text-align: center;">807 (10.8%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">edugp</td>
<td style="text-align: center;">university or more</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">19597 (92.9%)</td>
<td style="text-align: center;">1502 (7.1%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">high school</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">14943 (91.9%)</td>
<td style="text-align: center;">1318 (8.1%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">middle school or below</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">3200 (85.4%)</td>
<td style="text-align: center;">548 (14.6%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">empgp</td>
<td style="text-align: center;">paid-worker</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">25786 (92.4%)</td>
<td style="text-align: center;">2122 (7.6%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">employer/self-employer</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">2539 (91.7%)</td>
<td style="text-align: center;">229 (8.3%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">own-account worker</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">8359 (90.5%)</td>
<td style="text-align: center;">880 (9.5%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">unpaind family work</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">1056 (88.5%)</td>
<td style="text-align: center;">137 (11.5%)</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">AGE</td>
<td style="text-align: center;"></td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">46.8±12.4</td>
<td style="text-align: center;">49.7±11.9</td> 
<td style="text-align: center;" colspan="1">&nbsp;</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: center;">satisfaction</td>
<td style="border-bottom: 2px solid grey; text-align: center;"></td> 
<td style="border-bottom: 2px solid grey; text-align: center;" colspan="1">&nbsp;</td>
<td style="border-bottom: 2px solid grey; text-align: center;">2.1±0.5</td>
<td style="border-bottom: 2px solid grey; text-align: center;">2.4±0.6</td> 
<td style="border-bottom: 2px solid grey; text-align: center;" colspan="1">&nbsp;</td>
<td style="border-bottom: 2px solid grey; text-align: center;">&lt;0.001</td>
</tr>
</tbody>
<tfoot><tr><td colspan="7">
P value calculated by Chisq-Test and T-Test</td></tr></tfoot>
</table>
</div>
</div>
</section>
</section>
<section id="logistic-regression-table" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression-table">Logistic Regression Table</h2>
<p>일과 삶의 균형이 수면장애와 관련이 있는지 Logistic regression 을 수행해보고 이를 표로 만들어 보겠습니다. <br></p>
<p>R 로 로지스틱회귀분석을 수행하는 것은, 3가지 파트로 구성됩니다.</p>
<ul>
<li>Logistic Regression with R
<ul>
<li>data</li>
<li>family</li>
<li>model formula</li>
</ul></li>
</ul>
<p>이때 family는 “binomial”로 formula에서 종속변수의 값을 지정해 주고, <code>~</code> 이후에 보정변수를 <code>+</code>로 넣는 방법입니다. 아래의 예시를 보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">=</span> dat1 <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">data=</span>.,              <span class="co"># data 는 . 을 통해 상속 받고, </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family=</span><span class="st">"binomial"</span>,   <span class="co"># binomial로 구성</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> sleepgp <span class="sc">==</span> <span class="st">"1.sleep disturbance"</span>  <span class="co"># 모형 설정</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> wwa1gp)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1) <span class="co"># 모형 결과 정리</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = sleepgp == "1.sleep disturbance" ~ wwa1gp, family = "binomial", 
    data = .)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8450  -0.4522  -0.3357  -0.3300   2.4238  

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       -2.88303    0.03929 -73.378   &lt;2e-16 ***
wwa1gp1.Rarely     0.03526    0.05500   0.641    0.521    
wwa1gp2.Sometimes  0.65426    0.05170  12.655   &lt;2e-16 ***
wwa1gp3.Often      1.31024    0.05681  23.062   &lt;2e-16 ***
wwa1gp4.Always     2.03679    0.08245  24.704   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 23305  on 41107  degrees of freedom
Residual deviance: 22258  on 41103  degrees of freedom
AIC: 22268

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>우선 <code>summary</code>결과는 어떤 모델을 사용했는지 보여줍니다. 여기서 표를 만드는 이 수업의 목적에 가장 필요한 것은 <code>Coefficients</code>에 있습니다. <br> 각 변수에 대해서 <code>Estimation</code>에 logistic regression coefficients 값을 보여주고 있습니다. 이 값을 <code>exp(.)</code> 한 값이 Odds Ratio 가 될 것입니다. 우리가 <code>0.Never</code>를 기준으로 하여 값을 산출한 것이고, 이 값은 summary에 표시되어 있지 않습니다. <br> 그럼 coefficients 값을 가져오고, 여기에 exp(.)을 해서 odds ratio 값을 얻어 보겠습니다. 95% 신뢰구간은 <code>confint.default(model)</code>을 이용해서 구할 수 있습니다. p value 값도 가져오겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mod1<span class="sc">$</span>coefficients <span class="sc">%&gt;%</span> <span class="fu">exp</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      (Intercept)    wwa1gp1.Rarely wwa1gp2.Sometimes     wwa1gp3.Often 
       0.05596465        1.03589255        1.92371829        3.70707693 
   wwa1gp4.Always 
       7.66594719 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint.default</span>(mod1) <span class="sc">%&gt;%</span> <span class="fu">exp</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       2.5 %     97.5 %
(Intercept)       0.05181673 0.06044461
wwa1gp1.Rarely    0.93002700 1.15380884
wwa1gp2.Sometimes 1.73834069 2.12886464
wwa1gp3.Often     3.31643846 4.14372813
wwa1gp4.Always    6.52209339 9.01041165</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(term, p.value) <span class="co"># p value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  term                p.value
  &lt;chr&gt;                 &lt;dbl&gt;
1 (Intercept)       0        
2 wwa1gp1.Rarely    5.21e-  1
3 wwa1gp2.Sometimes 1.05e- 36
4 wwa1gp3.Often     1.11e-117
5 wwa1gp4.Always    9.62e-135</code></pre>
</div>
</div>
<p>각각을 엑셀등에 붙여 넣기 하여 표를 만들면 됩니다.</p>
<section id="로지스틱회귀분석-표-함수-1" class="level3">
<h3 class="anchored" data-anchor-id="로지스틱회귀분석-표-함수-1">로지스틱회귀분석 표 함수 1</h3>
<p>반복해서 만드는 것도 좋지만, 함수를 만들어 사용하는 것이 편리할 때도 있습니다. 만약 여러 데이터를 탐색적으로 분석할 때, 어떠한 변수가 유의한지 반복적으로 보고서를 만들때, 실수와 시간을 줄이려면 함수를 만들 필요가 있습니다. <br> 앞서서 만들 Odds Ratio, 95% CI, p value 를 합쳐 보겠습니다. 이것을 합치면, 우리가 원하는 표의 기본이 형성되었습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(mod1<span class="sc">$</span>coefficients<span class="sc">%&gt;%</span> <span class="fu">exp</span>(), <span class="fu">confint.default</span>(mod1)<span class="sc">%&gt;%</span> <span class="fu">exp</span>(), mod1 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(p.value)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  mod1$coefficients %&gt;% exp()      2.5 %     97.5 %
(Intercept)                        0.05596465 0.05181673 0.06044461
wwa1gp1.Rarely                     1.03589255 0.93002700 1.15380884
wwa1gp2.Sometimes                  1.92371829 1.73834069 2.12886464
wwa1gp3.Often                      3.70707693 3.31643846 4.14372813
wwa1gp4.Always                     7.66594719 6.52209339 9.01041165
                        p.value
(Intercept)        0.000000e+00
wwa1gp1.Rarely     5.214505e-01
wwa1gp2.Sometimes  1.048593e-36
wwa1gp3.Often     1.108932e-117
wwa1gp4.Always    9.619530e-135</code></pre>
</div>
</div>
<p>좀 코드가 길어보이니 함수를 만들어 보겠습니다. 이름을 mod summry function 을 줄여 modsmryf 으로 하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>modsmryf<span class="ot">=</span><span class="cf">function</span>(mod) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(mod<span class="sc">$</span>coefficients <span class="sc">%&gt;%</span> <span class="fu">exp</span>(.), <span class="fu">confint.default</span>(mod)<span class="sc">%&gt;%</span> <span class="fu">exp</span>(.), mod <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(p.value))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modsmryf</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  mod$coefficients %&gt;% exp(.)      2.5 %     97.5 %
(Intercept)                        0.05596465 0.05181673 0.06044461
wwa1gp1.Rarely                     1.03589255 0.93002700 1.15380884
wwa1gp2.Sometimes                  1.92371829 1.73834069 2.12886464
wwa1gp3.Often                      3.70707693 3.31643846 4.14372813
wwa1gp4.Always                     7.66594719 6.52209339 9.01041165
                        p.value
(Intercept)        0.000000e+00
wwa1gp1.Rarely     5.214505e-01
wwa1gp2.Sometimes  1.048593e-36
wwa1gp3.Often     1.108932e-117
wwa1gp4.Always    9.619530e-135</code></pre>
</div>
</div>
<p>이번에는 두번째 모델을 만들어 보겠습니다. 성별과 연령을 보정한 모델입니다. 이 모델도 앞서 만든 modsmryf 함수로 잘 표현될 수 있는 지 확인해 보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> dat1 <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">data=</span>., </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family=</span><span class="st">"binomial"</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> sleepgp <span class="sc">==</span> <span class="st">"1.sleep disturbance"</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> wwa1gp <span class="sc">+</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                  AGE <span class="sc">+</span> sexgp <span class="sc">+</span>satisfaction</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">modsmryf</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  mod$coefficients %&gt;% exp(.)       2.5 %      97.5 %
(Intercept)                       0.003804483 0.003053111 0.004740768
wwa1gp1.Rarely                    1.001621017 0.898377792 1.116729143
wwa1gp2.Sometimes                 1.833495422 1.654865417 2.031407164
wwa1gp3.Often                     3.420379336 3.053476051 3.831369432
wwa1gp4.Always                    6.907050334 5.845309980 8.161644888
AGE                               1.013712744 1.010590103 1.016845033
sexgpWomen                        1.532246823 1.421896138 1.651161618
satisfaction                      2.288037866 2.145736519 2.439776380
                        p.value
(Intercept)        0.000000e+00
wwa1gp1.Rarely     9.767193e-01
wwa1gp2.Sometimes  4.552779e-31
wwa1gp3.Often     3.967119e-100
wwa1gp4.Always    5.123559e-114
AGE                5.044326e-18
sexgpWomen         4.563279e-29
satisfaction      7.930347e-141</code></pre>
</div>
</div>
<p>이번엔 세번째는 shiftwork, njob을 보정해 보겠습니다. model 3를 의미하는 mod3로 저장하고 만들어 보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> dat1 <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">data=</span>., </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family=</span><span class="st">"binomial"</span>, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> sleepgp <span class="sc">==</span> <span class="st">"1.sleep disturbance"</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> wwa1gp <span class="sc">+</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                  AGE <span class="sc">+</span> sexgp <span class="sc">+</span>satisfaction<span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                  shiftWork <span class="sc">+</span> njob</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">modsmryf</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      mod$coefficients %&gt;% exp(.)       2.5 %      97.5 %
(Intercept)                           0.003567629 0.002858947 0.004451981
wwa1gp1.Rarely                        1.012175630 0.907728389 1.128641032
wwa1gp2.Sometimes                     1.877721635 1.694025217 2.081337693
wwa1gp3.Often                         3.491071324 3.114898897 3.912672415
wwa1gp4.Always                        7.046449183 5.959274630 8.331961382
AGE                                   1.014223241 1.011097186 1.017358962
sexgpWomen                            1.542246850 1.431082137 1.662046702
satisfaction                          2.272860173 2.131360030 2.423754454
shiftWork1.shift work                 1.510263841 1.324733670 1.721777683
njob1.njob                            1.588563409 1.150750845 2.192945340
                            p.value
(Intercept)            0.000000e+00
wwa1gp1.Rarely         8.275949e-01
wwa1gp2.Sometimes      3.779474e-33
wwa1gp3.Often         1.843134e-102
wwa1gp4.Always        1.977308e-115
AGE                    3.049355e-19
sexgpWomen             7.361792e-30
satisfaction          2.554569e-138
shiftWork1.shift work  7.049028e-10
njob1.njob             4.899856e-03</code></pre>
</div>
</div>
<p>이제 모델1, 2, 3가 만들어 졌습니다. 이걸 반복해서 만들고, 엑셀등에 붙여 넣기 하여 표를 만들면 됩니다.</p>
</section>
<section id="로지스틱-회귀분석-표-2" class="level3">
<h3 class="anchored" data-anchor-id="로지스틱-회귀분석-표-2">로지스틱 회귀분석 표 2</h3>
<p>앞선 함수를 조금더 업데이트 하겠습니다. 보통 보기편한 방식은 OR (95%CI) 로 표시하는 것입니다. 또한, 기준이되는 변수 값에는 “1.00 (reference)”로 표시하는 것이 필요합니다. 그럴려면, 사용된 변수의 모든 변수값의 종류는 표에 나타내어야 하는 basic matrix 가 필요합니다. 따라서 <br></p>
<ul>
<li>로지스틱 회귀분석 함수
<ul>
<li>사용된 변수의 Basic Matrix 만들기</li>
<li>기준된 변수 값에는 “1.00 (reference)” 값 주기</li>
<li>나머진 변수 에는 OR (95% CI) 나타내기</li>
</ul></li>
</ul>
<p>를 수행하면 됩니다.</p>
<blockquote class="blockquote">
<p>basic matrix</p>
</blockquote>
<p>명목변수(factor 등)과 연속변수를 나누어 basic matrix 를 만들겠습니다. 이는 logistic regression model 의 xlevels 와 model에 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mod3<span class="sc">$</span>xlevels </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$wwa1gp
[1] "0.Never"     "1.Rarely"    "2.Sometimes" "3.Often"     "4.Always"   

$sexgp
[1] "Men"   "Women"

$shiftWork
[1] "0.non shift work" "1.shift work"    

$njob
[1] "0.one-job" "1.njob"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mod3<span class="sc">$</span>model <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  AGE satisfaction
1  54            2
2  64            2</code></pre>
</div>
</div>
<p>이것을 data.frame 형식으로 만들겠습니다. list 형식으로, list 뒤에 [1] 을 통해 이름을, [[1]]을 통해 list 값을 가져오겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">=</span> mod3<span class="sc">$</span>xlevel</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="fu">names</span>(t1)[<span class="dv">1</span>], <span class="at">values=</span>t1[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  `names(t1)[1]` values     
  &lt;chr&gt;          &lt;chr&gt;      
1 wwa1gp         0.Never    
2 wwa1gp         1.Rarely   
3 wwa1gp         2.Sometimes
4 wwa1gp         3.Often    
5 wwa1gp         4.Always   </code></pre>
</div>
</div>
<p>이것을 함수로 나타내면, 아래와 같고, 이를 반복하면 다음과 같습니다 . 그런데 몇번 반복해야 할 까요?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="fu">names</span>(t1)[x], <span class="at">values=</span>t1[[x]])</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">test</span>(i))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  `names(t1)[x]` values     
  &lt;chr&gt;          &lt;chr&gt;      
1 wwa1gp         0.Never    
2 wwa1gp         1.Rarely   
3 wwa1gp         2.Sometimes
4 wwa1gp         3.Often    
5 wwa1gp         4.Always   
# A tibble: 2 × 2
  `names(t1)[x]` values
  &lt;chr&gt;          &lt;chr&gt; 
1 sexgp          Men   
2 sexgp          Women 
# A tibble: 2 × 2
  `names(t1)[x]` values          
  &lt;chr&gt;          &lt;chr&gt;           
1 shiftWork      0.non shift work
2 shiftWork      1.shift work    
# A tibble: 2 × 2
  `names(t1)[x]` values   
  &lt;chr&gt;          &lt;chr&gt;    
1 njob           0.one-job
2 njob           1.njob   </code></pre>
</div>
</div>
<p>몇 번 반복할지는 변수의 갯수가 몇개인지에 따라 달라집니다. 이를 통해 lapply, map을 이용해서 수행하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(mod3<span class="sc">$</span>xlevels) <span class="co"># 4개의 list가 있음을 알수 있습니다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 5 × 2
  `names(t1)[x]` values     
  &lt;chr&gt;          &lt;chr&gt;      
1 wwa1gp         0.Never    
2 wwa1gp         1.Rarely   
3 wwa1gp         2.Sometimes
4 wwa1gp         3.Often    
5 wwa1gp         4.Always   

[[2]]
# A tibble: 2 × 2
  `names(t1)[x]` values
  &lt;chr&gt;          &lt;chr&gt; 
1 sexgp          Men   
2 sexgp          Women 

[[3]]
# A tibble: 2 × 2
  `names(t1)[x]` values          
  &lt;chr&gt;          &lt;chr&gt;           
1 shiftWork      0.non shift work
2 shiftWork      1.shift work    

[[4]]
# A tibble: 2 × 2
  `names(t1)[x]` values   
  &lt;chr&gt;          &lt;chr&gt;    
1 njob           0.one-job
2 njob           1.njob   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 5 × 2
  `names(t1)[x]` values     
  &lt;chr&gt;          &lt;chr&gt;      
1 wwa1gp         0.Never    
2 wwa1gp         1.Rarely   
3 wwa1gp         2.Sometimes
4 wwa1gp         3.Often    
5 wwa1gp         4.Always   

[[2]]
# A tibble: 2 × 2
  `names(t1)[x]` values
  &lt;chr&gt;          &lt;chr&gt; 
1 sexgp          Men   
2 sexgp          Women 

[[3]]
# A tibble: 2 × 2
  `names(t1)[x]` values          
  &lt;chr&gt;          &lt;chr&gt;           
1 shiftWork      0.non shift work
2 shiftWork      1.shift work    

[[4]]
# A tibble: 2 × 2
  `names(t1)[x]` values   
  &lt;chr&gt;          &lt;chr&gt;    
1 njob           0.one-job
2 njob           1.njob   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mod3<span class="sc">$</span>xlevels), test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 5 × 2
  `names(t1)[x]` values     
  &lt;chr&gt;          &lt;chr&gt;      
1 wwa1gp         0.Never    
2 wwa1gp         1.Rarely   
3 wwa1gp         2.Sometimes
4 wwa1gp         3.Often    
5 wwa1gp         4.Always   

[[2]]
# A tibble: 2 × 2
  `names(t1)[x]` values
  &lt;chr&gt;          &lt;chr&gt; 
1 sexgp          Men   
2 sexgp          Women 

[[3]]
# A tibble: 2 × 2
  `names(t1)[x]` values          
  &lt;chr&gt;          &lt;chr&gt;           
1 shiftWork      0.non shift work
2 shiftWork      1.shift work    

[[4]]
# A tibble: 2 × 2
  `names(t1)[x]` values   
  &lt;chr&gt;          &lt;chr&gt;    
1 njob           0.one-job
2 njob           1.njob   </code></pre>
</div>
</div>
<p>이것을 통해 basic matrix를 만듭니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">=</span> mod3<span class="sc">$</span>xlevels</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>bm1 <span class="ot">=</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(t1), <span class="cf">function</span>(x){</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">variables =</span> <span class="fu">names</span>(t1)[x], </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">values =</span> t1[[x]])</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span> <span class="fu">do.call</span>(rbind, .)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>bm2 <span class="ot">=</span> mod3<span class="sc">$</span>model <span class="sc">%&gt;%</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">variables =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">values =</span><span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>bm0 <span class="ot">=</span><span class="fu">rbind</span>(bm1, bm2) <span class="sc">%&gt;%</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">keys=</span><span class="fu">paste0</span>(variables, values))</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>bm0 <span class="sc">%&gt;%</span> <span class="fu">htmlTable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr><th style="border-bottom: 1px solid grey; border-top: 2px solid grey;"></th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">variables</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">values</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">keys</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">0.Never</td>
<td style="text-align: center;">wwa1gp0.Never</td>
</tr>
<tr>
<td style="text-align: left;">2</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">1.Rarely</td>
<td style="text-align: center;">wwa1gp1.Rarely</td>
</tr>
<tr>
<td style="text-align: left;">3</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">2.Sometimes</td>
<td style="text-align: center;">wwa1gp2.Sometimes</td>
</tr>
<tr>
<td style="text-align: left;">4</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">3.Often</td>
<td style="text-align: center;">wwa1gp3.Often</td>
</tr>
<tr>
<td style="text-align: left;">5</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">4.Always</td>
<td style="text-align: center;">wwa1gp4.Always</td>
</tr>
<tr>
<td style="text-align: left;">6</td>
<td style="text-align: center;">sexgp</td>
<td style="text-align: center;">Men</td>
<td style="text-align: center;">sexgpMen</td>
</tr>
<tr>
<td style="text-align: left;">7</td>
<td style="text-align: center;">sexgp</td>
<td style="text-align: center;">Women</td>
<td style="text-align: center;">sexgpWomen</td>
</tr>
<tr>
<td style="text-align: left;">8</td>
<td style="text-align: center;">shiftWork</td>
<td style="text-align: center;">0.non shift work</td>
<td style="text-align: center;">shiftWork0.non shift work</td>
</tr>
<tr>
<td style="text-align: left;">9</td>
<td style="text-align: center;">shiftWork</td>
<td style="text-align: center;">1.shift work</td>
<td style="text-align: center;">shiftWork1.shift work</td>
</tr>
<tr>
<td style="text-align: left;">10</td>
<td style="text-align: center;">njob</td>
<td style="text-align: center;">0.one-job</td>
<td style="text-align: center;">njob0.one-job</td>
</tr>
<tr>
<td style="text-align: left;">11</td>
<td style="text-align: center;">njob</td>
<td style="text-align: center;">1.njob</td>
<td style="text-align: center;">njob1.njob</td>
</tr>
<tr>
<td style="text-align: left;">12</td>
<td style="text-align: center;">AGE</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">AGE</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">13</td>
<td style="border-bottom: 2px solid grey; text-align: center;">satisfaction</td>
<td style="border-bottom: 2px solid grey; text-align: center;"></td>
<td style="border-bottom: 2px solid grey; text-align: center;">satisfaction</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>odds ratio 를 정리해 보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>mm <span class="ot">=</span> <span class="fu">modsmryf</span>(mod3)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>mm1 <span class="ot">=</span> mm<span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"or"</span>, <span class="st">"ll"</span>, <span class="st">"ul"</span>, <span class="st">"pvalue"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">keys=</span><span class="fu">rownames</span>(mm)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이상의 것을 합쳐서 하나의 테이블로 만듭니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>bm0 <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mm1, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"keys"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">OR95CI =</span> <span class="fu">case_when</span>(</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(or) <span class="sc">~</span> <span class="st">"1.00 (reference)"</span>, </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"%.2f (%.2f-%.2f)"</span>, <span class="fu">round</span>(or, <span class="dv">2</span>), <span class="fu">round</span>(ll, <span class="dv">2</span>), <span class="fu">round</span>(ul, <span class="dv">2</span>))</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variables, values, OR95CI, pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pvalue =</span> <span class="fu">ifelse</span>(pvalue <span class="sc">&lt;</span><span class="fl">0.001</span>, <span class="st">"&lt;0.001"</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, pvalue))) <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">htmlTable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr><th style="border-bottom: 1px solid grey; border-top: 2px solid grey;"></th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">variables</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">values</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">OR95CI</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">pvalue</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">0.Never</td>
<td style="text-align: center;">1.00 (reference)</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">2</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">1.Rarely</td>
<td style="text-align: center;">1.01 (0.91-1.13)</td>
<td style="text-align: center;">0.828</td>
</tr>
<tr>
<td style="text-align: left;">3</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">2.Sometimes</td>
<td style="text-align: center;">1.88 (1.69-2.08)</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: left;">4</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">3.Often</td>
<td style="text-align: center;">3.49 (3.11-3.91)</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: left;">5</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">4.Always</td>
<td style="text-align: center;">7.05 (5.96-8.33)</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: left;">6</td>
<td style="text-align: center;">sexgp</td>
<td style="text-align: center;">Men</td>
<td style="text-align: center;">1.00 (reference)</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">7</td>
<td style="text-align: center;">sexgp</td>
<td style="text-align: center;">Women</td>
<td style="text-align: center;">1.54 (1.43-1.66)</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: left;">8</td>
<td style="text-align: center;">shiftWork</td>
<td style="text-align: center;">0.non shift work</td>
<td style="text-align: center;">1.00 (reference)</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">9</td>
<td style="text-align: center;">shiftWork</td>
<td style="text-align: center;">1.shift work</td>
<td style="text-align: center;">1.51 (1.32-1.72)</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="text-align: left;">10</td>
<td style="text-align: center;">njob</td>
<td style="text-align: center;">0.one-job</td>
<td style="text-align: center;">1.00 (reference)</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">11</td>
<td style="text-align: center;">njob</td>
<td style="text-align: center;">1.njob</td>
<td style="text-align: center;">1.59 (1.15-2.19)</td>
<td style="text-align: center;">0.005</td>
</tr>
<tr>
<td style="text-align: left;">12</td>
<td style="text-align: center;">AGE</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">1.01 (1.01-1.02)</td>
<td style="text-align: center;">&lt;0.001</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">13</td>
<td style="border-bottom: 2px solid grey; text-align: center;">satisfaction</td>
<td style="border-bottom: 2px solid grey; text-align: center;"></td>
<td style="border-bottom: 2px solid grey; text-align: center;">2.27 (2.13-2.42)</td>
<td style="border-bottom: 2px solid grey; text-align: center;">&lt;0.001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>이제 됬습니다. 이것을 통해 표를 만들면 되겠습니다. 반복 작업이 필요할 수도 있으니, 함수로 만들겠습니다. 다만 회귀분석 모델이 error가 있거나 하는 상황이 있으므로, argumet 값이 missing이 아닌 경우에 함수가 실행되게 하겠습니다. 또한 xlevels가 없는 경우, numeric 함수가 없을 경우에도 작동할 수 있도록, 아래와 같이 if else 를 사용해서 함수를 만듭니다. 또한 p value가 0.05보다 작은 경우 <strong>bold</strong> 로 표시하기 위해 html 언어인 <code>&lt;b&gt; ... &lt;/b&gt;</code> 를 사용하고, reference인 경우는 <code>&lt;i&gt;...&lt;/i&gt;</code>를 이용해서 italic 폰트를 구성하였습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>oddf<span class="ot">=</span><span class="cf">function</span>(a){</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">missing</span>(a)){  </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>mm <span class="ot">=</span> <span class="fu">modsmryf</span>(a)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>mm1 <span class="ot">=</span> mm<span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"or"</span>, <span class="st">"ll"</span>, <span class="st">"ul"</span>, <span class="st">"pvalue"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">keys=</span><span class="fu">rownames</span>(mm)) </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">any</span>(<span class="fu">is.na</span>(a<span class="sc">$</span>xlevels))){</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  t1 <span class="ot">=</span> a<span class="sc">$</span>xlevels</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  bm1 <span class="ot">=</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(t1),<span class="cf">function</span>(x){<span class="fu">tibble</span>(<span class="at">variables=</span> <span class="fu">names</span>(t1)[x], <span class="at">values =</span> t1[[x]])}) <span class="sc">%&gt;%</span> <span class="fu">do.call</span>(rbind, .)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  t1 <span class="ot">=</span> <span class="fu">data.frame</span>();bm1<span class="ot">=</span><span class="fu">data.frame</span>()</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(a<span class="sc">$</span>model <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))<span class="sc">%&gt;%</span> <span class="fu">unique</span>()) <span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    bm2 <span class="ot">=</span> a<span class="sc">$</span>model <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="fu">where</span>(is.numeric))<span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>()) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">variables =</span> name) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">values=</span><span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    bm2 <span class="ot">=</span> <span class="fu">data.frame</span>()  </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>bm0 <span class="ot">=</span> <span class="fu">rbind</span>(bm1, bm2) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">keys=</span> <span class="fu">paste0</span>(variables, values))</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>atab<span class="ot">=</span> bm0 <span class="sc">%&gt;%</span> </span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mm1, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"keys"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">OR95CI =</span> <span class="fu">case_when</span>(</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(or) <span class="sc">~</span> <span class="st">"&lt;i&gt;1.00 (reference)&lt;/i&gt;"</span>, </span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"&lt;b&gt;%.2f (%.2f-%.2f)&lt;/b&gt;"</span>, <span class="fu">round</span>(or, <span class="dv">2</span>), <span class="fu">round</span>(ll, <span class="dv">2</span>), <span class="fu">round</span>(ul, <span class="dv">2</span>)), </span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"%.2f (%.2f-%.2f)"</span>, <span class="fu">round</span>(or, <span class="dv">2</span>), <span class="fu">round</span>(ll, <span class="dv">2</span>), <span class="fu">round</span>(ul, <span class="dv">2</span>))</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">values =</span> <span class="fu">case_when</span>(</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    pvalue <span class="sc">&lt;</span><span class="fl">0.05</span> <span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"&lt;b&gt;%s&lt;/b&gt;"</span>, values), </span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> values</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variables, values, OR95CI) </span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(atab)</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>  atab <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">"variables"</span><span class="ot">=</span><span class="fu">c</span>(<span class="cn">NA</span>), <span class="st">"values"</span><span class="ot">=</span><span class="fu">c</span>(<span class="cn">NA</span>), <span class="st">"OR95CI"</span><span class="ot">=</span><span class="fu">c</span>(<span class="cn">NA</span>))</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(atab)</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>} <span class="sc">%&gt;%</span> <span class="fu">suppressWarnings</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>잘 작동하는 지 살펴 보겠습니다 .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oddf</span>(mod1) <span class="sc">%&gt;%</span> <span class="fu">htmlTable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr><th style="border-bottom: 1px solid grey; border-top: 2px solid grey;"></th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">variables</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">values</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">OR95CI</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">0.Never</td>
<td style="text-align: center;"><i>1.00 (reference)</i></td>
</tr>
<tr>
<td style="text-align: left;">2</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">1.Rarely</td>
<td style="text-align: center;">1.04 (0.93-1.15)</td>
</tr>
<tr>
<td style="text-align: left;">3</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;"><b>2.Sometimes</b></td>
<td style="text-align: center;"><b>1.92 (1.74-2.13)</b></td>
</tr>
<tr>
<td style="text-align: left;">4</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;"><b>3.Often</b></td>
<td style="text-align: center;"><b>3.71 (3.32-4.14)</b></td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">5</td>
<td style="border-bottom: 2px solid grey; text-align: center;">wwa1gp</td>
<td style="border-bottom: 2px solid grey; text-align: center;"><b>4.Always</b></td>
<td style="border-bottom: 2px solid grey; text-align: center;"><b>7.67 (6.52-9.01)</b></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="로지스틱-회귀분석-3" class="level3">
<h3 class="anchored" data-anchor-id="로지스틱-회귀분석-3">로지스틱 회귀분석 3</h3>
<p>그런데 만약 model을 여러개를 한번에 나타내려면 어떻게 하면될까요? 네 반복문을 사용해서 list를 만들고, 옆으로 붙이면 됩니다. <code>reduce해서 cbind하면됩니다.</code> <br></p>
<ul>
<li>여러 모델 표 구성하기
<ul>
<li>표 반복해서 만들기</li>
<li>list 횡 병합하기 (join)</li>
<li>모델 갯수 만큼 모델명 만들기</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>oddsf<span class="ot">=</span> <span class="cf">function</span>(...){</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  arglist <span class="ot">=</span> <span class="fu">list</span>(...)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#mod_list = mget(ls()) %&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#      list.filter(length(.)&gt;1)</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  tt <span class="ot">=</span> <span class="fu">map</span>(arglist, oddf) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">reduce</span>(full_join, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"variables"</span>, <span class="st">"values"</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  vl <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">length</span>(tt)<span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  tt <span class="ot">=</span> tt <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"Variables"</span>, <span class="st">"Values"</span>, <span class="fu">paste0</span>(<span class="st">"Model."</span>, <span class="fu">as.roman</span>(<span class="dv">1</span><span class="sc">:</span>vl))))</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tt)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>잘 작동하는지 보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oddsf</span>(mod1, mod2) <span class="sc">%&gt;%</span> <span class="fu">htmlTable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr><th style="border-bottom: 1px solid grey; border-top: 2px solid grey;"></th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">Variables</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">Values</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">Model.I</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">Model.II</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">0.Never</td>
<td style="text-align: center;"><i>1.00 (reference)</i></td>
<td style="text-align: center;"><i>1.00 (reference)</i></td>
</tr>
<tr>
<td style="text-align: left;">2</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;">1.Rarely</td>
<td style="text-align: center;">1.04 (0.93-1.15)</td>
<td style="text-align: center;">1.00 (0.90-1.12)</td>
</tr>
<tr>
<td style="text-align: left;">3</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;"><b>2.Sometimes</b></td>
<td style="text-align: center;"><b>1.92 (1.74-2.13)</b></td>
<td style="text-align: center;"><b>1.83 (1.65-2.03)</b></td>
</tr>
<tr>
<td style="text-align: left;">4</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;"><b>3.Often</b></td>
<td style="text-align: center;"><b>3.71 (3.32-4.14)</b></td>
<td style="text-align: center;"><b>3.42 (3.05-3.83)</b></td>
</tr>
<tr>
<td style="text-align: left;">5</td>
<td style="text-align: center;">wwa1gp</td>
<td style="text-align: center;"><b>4.Always</b></td>
<td style="text-align: center;"><b>7.67 (6.52-9.01)</b></td>
<td style="text-align: center;"><b>6.91 (5.85-8.16)</b></td>
</tr>
<tr>
<td style="text-align: left;">6</td>
<td style="text-align: center;">sexgp</td>
<td style="text-align: center;">Men</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><i>1.00 (reference)</i></td>
</tr>
<tr>
<td style="text-align: left;">7</td>
<td style="text-align: center;">sexgp</td>
<td style="text-align: center;"><b>Women</b></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><b>1.53 (1.42-1.65)</b></td>
</tr>
<tr>
<td style="text-align: left;">8</td>
<td style="text-align: center;">AGE</td>
<td style="text-align: center;"><b></b></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><b>1.01 (1.01-1.02)</b></td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">9</td>
<td style="border-bottom: 2px solid grey; text-align: center;">satisfaction</td>
<td style="border-bottom: 2px solid grey; text-align: center;"><b></b></td>
<td style="border-bottom: 2px solid grey; text-align: center;"></td>
<td style="border-bottom: 2px solid grey; text-align: center;"><b>2.29 (2.15-2.44)</b></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><code>oddsf</code> 함수 만으로는 조금 부족해 보입니다. 이제 이것을 좀더 보기 편하게 꾸며 보겠습니다. <br></p>
<ul>
<li>표 꾸미기
<ul>
<li>표 이름 만들기</li>
<li>중복 항목 지우기</li>
<li>NA 값을 빈칸으로 만들기</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>oddsTabf <span class="ot">=</span> <span class="cf">function</span>(...){</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  arglist <span class="ot">=</span> <span class="fu">list</span>(...)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  mod1 <span class="ot">=</span> arglist[[<span class="dv">1</span>]]</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  tt <span class="ot">=</span> <span class="fu">map</span>(arglist, oddf) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reduce</span>(full_join, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"variables"</span>, <span class="st">"values"</span>))</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  vl <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">length</span>(tt)<span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  ys <span class="ot">=</span>  mod1<span class="sc">$</span>formula[<span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">str_replace</span>(., <span class="st">"</span><span class="sc">\\</span><span class="st">=</span><span class="sc">\\</span><span class="st">="</span>, <span class="st">"being reference of"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(., <span class="st">'</span><span class="sc">\\</span><span class="st">"'</span>, <span class="st">""</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  tt <span class="ot">=</span> tt <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"Variables"</span>, <span class="st">"Values"</span>, <span class="fu">paste0</span>(<span class="st">"Model."</span>, <span class="fu">as.roman</span>(<span class="dv">1</span><span class="sc">:</span>vl))))</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  tt <span class="sc">%&gt;%</span>  <span class="st">`</span><span class="at">rownames&lt;-</span><span class="st">`</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Variables) <span class="sc">%&gt;%</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Variables =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="fu">min</span>(rank), Variables, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(., <span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">"Model"</span>)), <span class="sc">~</span><span class="fu">replace</span>(., <span class="fu">is.na</span>(.), <span class="st">""</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>rank) <span class="sc">%&gt;%</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">addHtmlTableStyle</span>(<span class="at">align =</span> <span class="st">'ll'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">htmlTable</span>(</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="fu">sprintf</span>(<span class="st">"Table. OR(95%%CI) for %s"</span>, ys)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>잘 작동하는지 알아보겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oddsTabf</span>(mod1, mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr><td colspan="6" style="text-align: left;">
Table. OR(95%CI) for sleepgp being reference of 1.sleep disturbance</td></tr>
<tr><th style="border-bottom: 1px solid grey; border-top: 2px solid grey;"></th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">Variables</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">Values</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">Model.I</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">Model.II</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">Model.III</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: left;">wwa1gp</td>
<td style="text-align: left;">0.Never</td>
<td style="text-align: left;"><i>1.00 (reference)</i></td>
<td style="text-align: left;"><i>1.00 (reference)</i></td>
<td style="text-align: left;"><i>1.00 (reference)</i></td>
</tr>
<tr>
<td style="text-align: left;">2</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1.Rarely</td>
<td style="text-align: left;">1.04 (0.93-1.15)</td>
<td style="text-align: left;">1.00 (0.90-1.12)</td>
<td style="text-align: left;">1.01 (0.91-1.13)</td>
</tr>
<tr>
<td style="text-align: left;">3</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><b>2.Sometimes</b></td>
<td style="text-align: left;"><b>1.92 (1.74-2.13)</b></td>
<td style="text-align: left;"><b>1.83 (1.65-2.03)</b></td>
<td style="text-align: left;"><b>1.88 (1.69-2.08)</b></td>
</tr>
<tr>
<td style="text-align: left;">4</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><b>3.Often</b></td>
<td style="text-align: left;"><b>3.71 (3.32-4.14)</b></td>
<td style="text-align: left;"><b>3.42 (3.05-3.83)</b></td>
<td style="text-align: left;"><b>3.49 (3.11-3.91)</b></td>
</tr>
<tr>
<td style="text-align: left;">5</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><b>4.Always</b></td>
<td style="text-align: left;"><b>7.67 (6.52-9.01)</b></td>
<td style="text-align: left;"><b>6.91 (5.85-8.16)</b></td>
<td style="text-align: left;"><b>7.05 (5.96-8.33)</b></td>
</tr>
<tr>
<td style="text-align: left;">6</td>
<td style="text-align: left;">sexgp</td>
<td style="text-align: left;">Men</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><i>1.00 (reference)</i></td>
<td style="text-align: left;"><i>1.00 (reference)</i></td>
</tr>
<tr>
<td style="text-align: left;">7</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><b>Women</b></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><b>1.53 (1.42-1.65)</b></td>
<td style="text-align: left;"><b>1.54 (1.43-1.66)</b></td>
</tr>
<tr>
<td style="text-align: left;">8</td>
<td style="text-align: left;">AGE</td>
<td style="text-align: left;"><b></b></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><b>1.01 (1.01-1.02)</b></td>
<td style="text-align: left;"><b>1.01 (1.01-1.02)</b></td>
</tr>
<tr>
<td style="text-align: left;">9</td>
<td style="text-align: left;">satisfaction</td>
<td style="text-align: left;"><b></b></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><b>2.29 (2.15-2.44)</b></td>
<td style="text-align: left;"><b>2.27 (2.13-2.42)</b></td>
</tr>
<tr>
<td style="text-align: left;">10</td>
<td style="text-align: left;">shiftWork</td>
<td style="text-align: left;">0.non shift work</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><i>1.00 (reference)</i></td>
</tr>
<tr>
<td style="text-align: left;">11</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><b>1.shift work</b></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><b>1.51 (1.32-1.72)</b></td>
</tr>
<tr>
<td style="text-align: left;">12</td>
<td style="text-align: left;">njob</td>
<td style="text-align: left;">0.one-job</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><i>1.00 (reference)</i></td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">13</td>
<td style="border-bottom: 2px solid grey; text-align: left;"></td>
<td style="border-bottom: 2px solid grey; text-align: left;"><b>1.njob</b></td>
<td style="border-bottom: 2px solid grey; text-align: left;"></td>
<td style="border-bottom: 2px solid grey; text-align: left;"></td>
<td style="border-bottom: 2px solid grey; text-align: left;"><b>1.59 (1.15-2.19)</b></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>이 것을 source 파일로 저장하겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"source/oddsTabf.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>수고하셨습니다.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>